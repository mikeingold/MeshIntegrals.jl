<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Integrating a Triangle · MeshIntegrals.jl</title><meta name="title" content="Integrating a Triangle · MeshIntegrals.jl"/><meta property="og:title" content="Integrating a Triangle · MeshIntegrals.jl"/><meta property="twitter:title" content="Integrating a Triangle · MeshIntegrals.jl"/><meta name="description" content="Documentation for MeshIntegrals.jl."/><meta property="og:description" content="Documentation for MeshIntegrals.jl."/><meta property="twitter:description" content="Documentation for MeshIntegrals.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MeshIntegrals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../">About</a></li><li><a class="tocitem" href="../how_it_works/">How it Works</a></li><li><a class="tocitem" href="../supportmatrix/">Support Matrix</a></li><li><a class="tocitem" href="../usage/">Example Usage</a></li></ul></li><li><span class="tocitem">Derivations</span><ul><li class="is-active"><a class="tocitem" href>Integrating a Triangle</a></li></ul></li><li><a class="tocitem" href="../api/">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Derivations</a></li><li class="is-active"><a href>Integrating a Triangle</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Integrating a Triangle</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeometry/MeshIntegrals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeometry/MeshIntegrals.jl/blob/main/docs/src/triangle.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Integrating-a-Triangle"><a class="docs-heading-anchor" href="#Integrating-a-Triangle">Integrating a Triangle</a><a id="Integrating-a-Triangle-1"></a><a class="docs-heading-anchor-permalink" href="#Integrating-a-Triangle" title="Permalink"></a></h1><p>For a specified <code>Meshes.Triangle</code> surface with area <span>$A$</span>, let <span>$u$</span> and <span>$v$</span> be Barycentric coordinates that span the surface.</p><p class="math-container">\[\int_\triangle f(\bar{r}) \, \text{d}A
    = \iint_\triangle f\left( \bar{r}(u,v) \right) \, \left( \text{d}u \wedge \text{d}v \right)\]</p><p>Since the geometric transformation from the originally-arbitrary domain to a Barycentric domain is linear, the magnitude of the surface element <span>$\text{d}u \wedge \text{d}v$</span> is constant throughout the integration domain. This constant will be equal to twice the magnitude of <span>$A$</span>.</p><p class="math-container">\[\int_\triangle f(\bar{r}) \, \text{d}A
    = 2A \int_0^1 \int_0^{1-v} f\left( \bar{r}(u,v) \right) \, \text{d}u \, \text{d}v\]</p><p>Since the integral domain is a right-triangle in the Barycentric domain, a nested application of Gauss-Kronrod quadrature rules is capable of computing the result, albeit inefficiently. However, many numerical integration methods that require rectangular bounds can not be directly applied.</p><p>In order to enable integration methods that operate over rectangular bounds, two coordinate system transformations are applied: the first maps from Barycentric coordinates <span>$(u, v)$</span> to polar coordinates <span>$(r, \phi)$</span>, and the second is a non-linear map from polar coordinates to a new curvilinear basis <span>$(R, \phi)$</span>.</p><p>For the first transformation, let <span>$u = r~\cos\phi$</span> and <span>$v = r~\sin\phi$</span> where <span>$\text{d}u~\text{d}v = r~\text{d}r~\text{d}\phi$</span>. The Barycentric triangle&#39;s hypotenuse boundary line is described by the function <span>$v(u) = 1 - u$</span>. Substituting in the previous definitions leads to a new boundary line function in polar coordinate space <span>$r(\phi) = 1 / (\sin\phi + \cos\phi)$</span>.</p><p class="math-container">\[\int_0^1 \int_0^{1-v} f\left( \bar{r}(u,v) \right) \, \text{d}u \, \text{d}v =
    \int_0^{\pi/2} \int_0^{1/(\sin\phi+\cos\phi)} f\left( \bar{r}(r,\phi) \right) \, r \, \text{d}r \, \text{d}\phi\]</p><p>These integral boundaries remain non-rectangular, so an additional transformation will be applied to a curvilinear <span>$(R, \phi)$</span> space that normalizes all of the hypotenuse boundary line points to <span>$R=1$</span>. To achieve this, a function <span>$R(r,\phi)$</span> is required such that <span>$R(r_0, \phi) = 1$</span> where <span>$r_0 = 1 / (\sin\phi + \cos\phi)$</span></p><p>To achieve this, let <span>$R(r, \phi) = r~(\sin\phi + \cos\phi)$</span>. Now, substituting some terms leads to</p><p class="math-container">\[\int_0^{\pi/2} \int_0^{1/(\sin\phi+\cos\phi)} f\left( \bar{r}(r,\phi) \right) \, r \, \text{d}r \, \text{d}\phi
    = \int_0^{\pi/2} \int_0^{r_0} f\left( \bar{r}(r,\phi) \right) \, \left(\frac{R}{\sin\phi + \cos\phi}\right) \, \text{d}r \, \text{d}\phi\]</p><p>Since <span>$\text{d}R/\text{d}r = \sin\phi + \cos\phi$</span>, a change of integral domain leads to</p><p class="math-container">\[\int_0^{\pi/2} \int_0^{r_0} f\left( \bar{r}(r,\phi) \right) \, \left(\frac{R}{\sin\phi + \cos\phi}\right) \, \text{d}r \, \text{d}\phi
    = \int_0^{\pi/2} \int_0^1 f\left( \bar{r}(R,\phi) \right) \, \left(\frac{R}{\left(\sin\phi + \cos\phi\right)^2}\right) \, \text{d}R \, \text{d}\phi\]</p><p>The second term in this new integrand function serves as a correction factor that corrects for the impact of the non-linear domain transformation. Since all of the integration bounds are now constants, specialized integration methods can be defined for triangles that performs these domain transformations and then solve the new rectangular integration problem using a wider range of solver options.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Example Usage</a><a class="docs-footer-nextpage" href="../api/">Public API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 5 November 2024 00:03">Tuesday 5 November 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
